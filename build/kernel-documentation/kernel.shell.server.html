<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>kernel.shell.server documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Kernel</span> <span class="project-version">SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kernel</span></div></div></li><li class="depth-2 branch"><a href="kernel.api.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></a></li><li class="depth-2"><a href="kernel.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.causal-dag.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>causal-dag</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.compound-operation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compound-operation</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.conflict-cache.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>conflict-cache</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.conflict-relation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>conflict-relation</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.conflict-resolution.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>conflict-resolution</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.feature-model.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>feature-model</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.garbage-collector.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>garbage-collector</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.history-buffer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>history-buffer</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.message.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>message</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.movic.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>movic</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.primitive-operation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>primitive-operation</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.topological-sort.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>topological-sort</span></div></a></li><li class="depth-3"><a href="kernel.core.vector-clock.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vector-clock</span></div></a></li><li class="depth-2 branch"><a href="kernel.helpers.html"><div class="inner"><span class="tree" style="top: -424px;"><span class="top" style="height: 433px;"></span><span class="bottom"></span></span><span>helpers</span></div></a></li><li class="depth-2 branch"><a href="kernel.i18n.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>i18n</span></div></a></li><li class="depth-2"><a href="kernel.shell.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shell</span></div></a></li><li class="depth-3 branch"><a href="kernel.shell.client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></a></li><li class="depth-3 branch"><a href="kernel.shell.context.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>context</span></div></a></li><li class="depth-3 branch current"><a href="kernel.shell.server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>server</span></div></a></li><li class="depth-3"><a href="kernel.shell.site.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>site</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="kernel.shell.server.html#var-forward-message.21"><div class="inner"><span>forward-message!</span></div></a></li><li class="depth-1"><a href="kernel.shell.server.html#var-GC.21"><div class="inner"><span>GC!</span></div></a></li><li class="depth-1"><a href="kernel.shell.server.html#var-GC-filter"><div class="inner"><span>GC-filter</span></div></a></li><li class="depth-1"><a href="kernel.shell.server.html#var-generate-heartbeat.21"><div class="inner"><span>generate-heartbeat!</span></div></a></li><li class="depth-1"><a href="kernel.shell.server.html#var-initialize-context-star-topology"><div class="inner"><span>initialize-context-star-topology</span></div></a></li><li class="depth-1"><a href="kernel.shell.server.html#var-initialize-context-star-topology.21"><div class="inner"><span>initialize-context-star-topology!</span></div></a></li><li class="depth-1"><a href="kernel.shell.server.html#var-resolve-conflict.21"><div class="inner"><span>resolve-conflict!</span></div></a></li><li class="depth-1"><a href="kernel.shell.server.html#var-site-joined.21"><div class="inner"><span>site-joined!</span></div></a></li><li class="depth-1"><a href="kernel.shell.server.html#var-site-left.21"><div class="inner"><span>site-left!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">kernel.shell.server</h1><div class="doc"><div class="markdown"><p>Server site control.</p>
<p>Generates and receives messages at the server site. Modifies the global context. Site control operations are assumed to run atomically in a single thread, no synchronization is performed.</p></div></div><div class="public anchor" id="var-forward-message.21"><h3>forward-message!</h3><div class="usage"><code>(forward-message! message)</code></div><div class="doc"><div class="markdown"><p>Receives, processes and forwards a message from a client site to all other client sites. If a site has left in the meantime, removes its vector clock coordinate from forwarded messages (as other sites have already been notified about the leaving site). Returns the message that is to be forwarded.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/d8d5f60e8e624ceeb497508b277fab94f50dcd87/kernel/src/kernel/shell/server.cljc#L60">view source</a></div></div><div class="public anchor" id="var-GC.21"><h3>GC!</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Runs the garbage collector at the server site. Updates the global context.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/d8d5f60e8e624ceeb497508b277fab94f50dcd87/kernel/src/kernel/shell/server.cljc#L126">view source</a></div></div><div class="public anchor" id="var-GC-filter"><h3>GC-filter</h3><div class="usage"><code>(GC-filter server-VC)</code></div><div class="doc"><div class="markdown"><p>Removes the server coordinate from a vector clock. This is required so that no client site unnecessarily takes into account the server coordinate.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/d8d5f60e8e624ceeb497508b277fab94f50dcd87/kernel/src/kernel/shell/server.cljc#L20">view source</a></div></div><div class="public anchor" id="var-generate-heartbeat.21"><h3>generate-heartbeat!</h3><div class="usage"><code>(generate-heartbeat!)</code></div><div class="doc"><div class="markdown"><p>Generates a heartbeat message at the server site. Only required to improve the performance of garbage collection. Only sent explicitly if no messages have been forwarded for a while.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/d8d5f60e8e624ceeb497508b277fab94f50dcd87/kernel/src/kernel/shell/server.cljc#L48">view source</a></div></div><div class="public anchor" id="var-initialize-context-star-topology"><h3>initialize-context-star-topology</h3><div class="usage"><code>(initialize-context-star-topology initial-FM)</code></div><div class="doc"><div class="markdown"><p>Initializes global context for the server site in a star topology. Called when first client site connects and requests to edit a given feature model.</p>
<p>The server receives all operations eventually. The server’s vector clock is the maximum of all its received operation’s vector clocks (save for its own vector clock coordinate).</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/d8d5f60e8e624ceeb497508b277fab94f50dcd87/kernel/src/kernel/shell/server.cljc#L26">view source</a></div></div><div class="public anchor" id="var-initialize-context-star-topology.21"><h3>initialize-context-star-topology!</h3><div class="usage"><code>(initialize-context-star-topology! initial-FM)</code></div><div class="doc"><div class="markdown"><p>Initializes global context for the server site in a star topology. Resets the global context.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/d8d5f60e8e624ceeb497508b277fab94f50dcd87/kernel/src/kernel/shell/server.cljc#L39">view source</a></div></div><div class="public anchor" id="var-resolve-conflict.21"><h3>resolve-conflict!</h3><div class="usage"><code>(resolve-conflict! MCG-ID)</code></div><div class="doc"><div class="markdown"><p>Resolves a conflict to a given version. Returns the (updated) combined effect.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/d8d5f60e8e624ceeb497508b277fab94f50dcd87/kernel/src/kernel/shell/server.cljc#L119">view source</a></div></div><div class="public anchor" id="var-site-joined.21"><h3>site-joined!</h3><div class="usage"><code>(site-joined! site-ID)</code></div><div class="doc"><div class="markdown"><p>Processes a newly joined site. Prepares an initial context for the new site. Updates the server’s global context to include the new site. Generates an initial heartbeat message for the new site that is to be forwarded to other sites (effectively simulating that the first message received by the site is this very heartbeat). Returns the new site’s initial context and the generated heartbeat message.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/d8d5f60e8e624ceeb497508b277fab94f50dcd87/kernel/src/kernel/shell/server.cljc#L75">view source</a></div></div><div class="public anchor" id="var-site-left.21"><h3>site-left!</h3><div class="usage"><code>(site-left! site-ID)</code></div><div class="doc"><div class="markdown"><p>Processes a leaving site. Generates a leave message for the new site that is to be forwarded to other sites (effectively simulating that the last message received by the site is this leave message). Adds the site to the list of offline sites so that forwarded messages can be pruned of this site’s coordinate. <strong>TODO</strong>: Garbage collect the list of offline sites after every user has seen the leave (e.g., attach this to a heartbeat that everyone has to succeed).</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/d8d5f60e8e624ceeb497508b277fab94f50dcd87/kernel/src/kernel/shell/server.cljc#L102">view source</a></div></div></div></body></html>