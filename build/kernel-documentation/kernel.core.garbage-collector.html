<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>kernel.core.garbage-collector documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Kernel</span> <span class="project-version">SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kernel</span></div></div></li><li class="depth-2 branch"><a href="kernel.api.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></a></li><li class="depth-2"><a href="kernel.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.causal-dag.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>causal-dag</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.compound-operation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compound-operation</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.conflict-cache.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>conflict-cache</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.conflict-relation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>conflict-relation</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.conflict-resolution.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>conflict-resolution</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.feature-model.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>feature-model</span></div></a></li><li class="depth-3 branch current"><a href="kernel.core.garbage-collector.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>garbage-collector</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.history-buffer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>history-buffer</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.message.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>message</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.movic.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>movic</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.primitive-operation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>primitive-operation</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.topological-sort.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>topological-sort</span></div></a></li><li class="depth-3"><a href="kernel.core.vector-clock.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vector-clock</span></div></a></li><li class="depth-2 branch"><a href="kernel.helpers.html"><div class="inner"><span class="tree" style="top: -424px;"><span class="top" style="height: 433px;"></span><span class="bottom"></span></span><span>helpers</span></div></a></li><li class="depth-2 branch"><a href="kernel.i18n.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>i18n</span></div></a></li><li class="depth-2"><a href="kernel.shell.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shell</span></div></a></li><li class="depth-3 branch"><a href="kernel.shell.client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></a></li><li class="depth-3 branch"><a href="kernel.shell.context.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>context</span></div></a></li><li class="depth-3 branch"><a href="kernel.shell.server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>server</span></div></a></li><li class="depth-3"><a href="kernel.shell.site.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>site</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="kernel.core.garbage-collector.html#var-eligible.3F"><div class="inner"><span>eligible?</span></div></a></li><li class="depth-1"><a href="kernel.core.garbage-collector.html#var-GC"><div class="inner"><span>GC</span></div></a></li><li class="depth-1"><a href="kernel.core.garbage-collector.html#var-get-other-client-site-IDs"><div class="inner"><span>get-other-client-site-IDs</span></div></a></li><li class="depth-1"><a href="kernel.core.garbage-collector.html#var-get-site-IDs"><div class="inner"><span>get-site-IDs</span></div></a></li><li class="depth-1"><a href="kernel.core.garbage-collector.html#var-get-site-VC"><div class="inner"><span>get-site-VC</span></div></a></li><li class="depth-1"><a href="kernel.core.garbage-collector.html#var-initialize"><div class="inner"><span>initialize</span></div></a></li><li class="depth-1"><a href="kernel.core.garbage-collector.html#var-insert"><div class="inner"><span>insert</span></div></a></li><li class="depth-1"><a href="kernel.core.garbage-collector.html#var-remove-site"><div class="inner"><span>remove-site</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">kernel.core.garbage-collector</h1><div class="doc"><div class="markdown"><p>Garbage Collector, GC for short. Periodically prunes a site’s data structures to keep them as small as possible.</p>
<p>This is a non-essential performance optimization, but highly recommended because these data structures may grow unbounded over time; as many algorithms run in O(n), the system may also slow down over time.</p>
<p>The pruned data structures contain operations, so a criterion for determining operations suitable for garbage collection is provided by <a href="kernel.core.garbage-collector.html#var-eligible.3F">eligible?</a>. This criterion requires the garbage collector to store the most recently received vector clock from every site.</p>
<p>The garbage collector’s data grows in O(n) where n is the number of sites in the system.</p></div></div><div class="public anchor" id="var-eligible.3F"><h3>eligible?</h3><div class="usage"><code>(eligible? GC CO)</code></div><div class="doc"><div class="markdown"><p>Returns whether an operation may be garbage collected in O(n) for n sites (considering <a href="kernel.core.vector-clock.html#var-_.3C">kernel.core.vector-clock/_&lt;</a> as O(1)). An operation may be garbage collected if and only if it has been causally-succeeded by every site in the system. In that case, that operation can never again cause a conflict and is safe to discard. <strong>TODO</strong>: This has some interactions with undo/redo (i.e., an operation and its successors must not be discarded as long as any site may still request to undo it.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/6d3070ae5e83bec40fab2465efdf4bc3f95ec526/kernel/src/kernel/core/garbage_collector.cljc#L35">view source</a></div></div><div class="public anchor" id="var-GC"><h3>GC</h3><div class="usage"><code>(GC GC CDAG HB base-FM CC MCGS)</code></div><div class="doc"><div class="markdown"><p>Performs garbage collection in O(n) for n operations. Returns the given data structures, only pruned from any operations <a href="kernel.core.garbage-collector.html#var-eligible.3F">eligible?</a> for garbage collection.</p>
<p>Assumes that CDAG, HB, (possibly) CC and MCGS contain the same operations, guarantees the same as a post-condition.</p>
<p>All eligible operations have been succeeded by every site, so they may be applied in any topological order to produce a new base feature model: They are all compatible, otherwise no operation could succeed them all as the system is frozen on conflict; and there are no holes (i.e., missing operations) because the operation succeeding the hole would also not be eligible because it if it was, the hole would have been as well.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/6d3070ae5e83bec40fab2465efdf4bc3f95ec526/kernel/src/kernel/core/garbage_collector.cljc#L85">view source</a></div></div><div class="public anchor" id="var-get-other-client-site-IDs"><h3>get-other-client-site-IDs</h3><div class="usage"><code>(get-other-client-site-IDs GC own-site-ID)</code></div><div class="doc"><div class="markdown"><p>Returns all sites known to the local site but the server and local site. This is done for synchronization, where the server need not be considered as it does not participate in conflict resolution. Also, the server is not per se obliged to send heartbeats as clients when they become conflict-aware. The local site is, when synchronizing, already conflict-aware by definition.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/6d3070ae5e83bec40fab2465efdf4bc3f95ec526/kernel/src/kernel/core/garbage_collector.cljc#L68">view source</a></div></div><div class="public anchor" id="var-get-site-IDs"><h3>get-site-IDs</h3><div class="usage"><code>(get-site-IDs GC)</code></div><div class="doc"><div class="markdown"><p>Returns all sites known to the local site. Notably, this need not include recently joined sites (for which no heartbeat has arrived yet) and sites which have just left (for which no leave message has arrived yet).</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/6d3070ae5e83bec40fab2465efdf4bc3f95ec526/kernel/src/kernel/core/garbage_collector.cljc#L61">view source</a></div></div><div class="public anchor" id="var-get-site-VC"><h3>get-site-VC</h3><div class="usage"><code>(get-site-VC GC site-ID)</code></div><div class="doc"><div class="markdown"><p>Returns the garbage collector’s most recently received vector clock for a given site. This is useful to determine whether a site has succeeded some other vector clock.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/6d3070ae5e83bec40fab2465efdf4bc3f95ec526/kernel/src/kernel/core/garbage_collector.cljc#L79">view source</a></div></div><div class="public anchor" id="var-initialize"><h3>initialize</h3><div class="usage"><code>(initialize)</code></div><div class="doc"><div class="markdown"><p>Initializes the garbage collector with no sites.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/6d3070ae5e83bec40fab2465efdf4bc3f95ec526/kernel/src/kernel/core/garbage_collector.cljc#L28">view source</a></div></div><div class="public anchor" id="var-insert"><h3>insert</h3><div class="usage"><code>(insert GC site-ID VC)</code></div><div class="doc"><div class="markdown"><p>Updates the garbage collector’s most recently received vector clock for a given site in O(1).</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/6d3070ae5e83bec40fab2465efdf4bc3f95ec526/kernel/src/kernel/core/garbage_collector.cljc#L51">view source</a></div></div><div class="public anchor" id="var-remove-site"><h3>remove-site</h3><div class="usage"><code>(remove-site GC site-ID)</code></div><div class="doc"><div class="markdown"><p>Removes the garbage collector’s most recently received vector clock for a given site in O(1).</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/6d3070ae5e83bec40fab2465efdf4bc3f95ec526/kernel/src/kernel/core/garbage_collector.cljc#L56">view source</a></div></div></div></body></html>