<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>kernel.core.message documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Kernel</span> <span class="project-version">SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kernel</span></div></div></li><li class="depth-2 branch"><a href="kernel.api.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></a></li><li class="depth-2"><a href="kernel.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.causal-dag.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>causal-dag</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.compound-operation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compound-operation</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.conflict-cache.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>conflict-cache</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.conflict-relation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>conflict-relation</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.feature-model.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>feature-model</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.garbage-collector.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>garbage-collector</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.history-buffer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>history-buffer</span></div></a></li><li class="depth-3 branch current"><a href="kernel.core.message.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>message</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.movic.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>movic</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.primitive-operation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>primitive-operation</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.topological-sort.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>topological-sort</span></div></a></li><li class="depth-3"><a href="kernel.core.vector-clock.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vector-clock</span></div></a></li><li class="depth-2 branch"><a href="kernel.helpers.html"><div class="inner"><span class="tree" style="top: -393px;"><span class="top" style="height: 402px;"></span><span class="bottom"></span></span><span>helpers</span></div></a></li><li class="depth-2"><a href="kernel.shell.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shell</span></div></a></li><li class="depth-3 branch"><a href="kernel.shell.client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></a></li><li class="depth-3 branch"><a href="kernel.shell.context.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>context</span></div></a></li><li class="depth-3 branch"><a href="kernel.shell.server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>server</span></div></a></li><li class="depth-3"><a href="kernel.shell.site.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>site</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="kernel.core.message.html#var-get-server-VC"><div class="inner"><span>get-server-VC</span></div></a></li><li class="depth-1"><a href="kernel.core.message.html#var-get-site-ID"><div class="inner"><span>get-site-ID</span></div></a></li><li class="depth-1"><a href="kernel.core.message.html#var-get-type"><div class="inner"><span>get-type</span></div></a></li><li class="depth-1"><a href="kernel.core.message.html#var-get-VC"><div class="inner"><span>get-VC</span></div></a></li><li class="depth-1"><a href="kernel.core.message.html#var-make-heartbeat"><div class="inner"><span>make-heartbeat</span></div></a></li><li class="depth-1"><a href="kernel.core.message.html#var-make-leave"><div class="inner"><span>make-leave</span></div></a></li><li class="depth-1"><a href="kernel.core.message.html#var-make-operation"><div class="inner"><span>make-operation</span></div></a></li><li class="depth-1"><a href="kernel.core.message.html#var-operation-.3ECO"><div class="inner"><span>operation-&gt;CO</span></div></a></li><li class="depth-1"><a href="kernel.core.message.html#var-remove-server-VC"><div class="inner"><span>remove-server-VC</span></div></a></li><li class="depth-1"><a href="kernel.core.message.html#var-update-VC"><div class="inner"><span>update-VC</span></div></a></li><li class="depth-1"><a href="kernel.core.message.html#var-with-server-VC"><div class="inner"><span>with-server-VC</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">kernel.core.message</h1><div class="doc"><div class="markdown"><p>Defines what kinds of messages are exchanged among sites.</p>
<p>There are three kinds of messages:</p>
<ul>
  <li>An operation message carries a compound operation that is to be executed  on all sites in the system.</li>
  <li>A heartbeat message carries a site’s latest vector clock.  This is used as a performance optimization for the garbage collector  (without periodic heartbeats, no operations can be garbage collected).  They also announce a newly joined site.</li>
  <li>A leave message announces that a site has left.</li>
</ul>
<p>Every message forwarded by the server contains the server’s own vector clock. This is required for garbage collection, as the server also has to receive an operation for it to be <a href="kernel.core.garbage-collector.html#var-eligible.3F">kernel.core.garbage-collector/eligible?</a>. This is particularly important when only one client is connected to the server, so that the client does not immediately garbage collect its own operations.</p></div></div><div class="public anchor" id="var-get-server-VC"><h3>get-server-VC</h3><div class="usage"><code>(get-server-VC message)</code></div><div class="doc"><div class="markdown"><p>Returns a message’s server vector clock. Not every message carries this vector clock (i.e., forwarded messages and heartbeats for joined sites).</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/cabec88e9969ae94183684dafb62c8d0dc46a1c8/kernel/src/kernel/core/message.cljc#L58">view source</a></div></div><div class="public anchor" id="var-get-site-ID"><h3>get-site-ID</h3><div class="usage"><code>(get-site-ID message)</code></div><div class="doc"><div class="markdown"><p>Returns a message’s site. This is the site that issued the message, or a site that has left.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/cabec88e9969ae94183684dafb62c8d0dc46a1c8/kernel/src/kernel/core/message.cljc#L75">view source</a></div></div><div class="public anchor" id="var-get-type"><h3>get-type</h3><div class="usage"><code>(get-type message)</code></div><div class="doc"><div class="markdown"><p>Returns a message’s type, one of :heartbeat, :leave or nil (operation).</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/cabec88e9969ae94183684dafb62c8d0dc46a1c8/kernel/src/kernel/core/message.cljc#L42">view source</a></div></div><div class="public anchor" id="var-get-VC"><h3>get-VC</h3><div class="usage"><code>(get-VC message)</code></div><div class="doc"><div class="markdown"><p>Returns a message’s vector clock, if any. Leave messages do not carry a vector clock.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/cabec88e9969ae94183684dafb62c8d0dc46a1c8/kernel/src/kernel/core/message.cljc#L47">view source</a></div></div><div class="public anchor" id="var-make-heartbeat"><h3>make-heartbeat</h3><div class="usage"><code>(make-heartbeat VC site-ID)</code></div><div class="doc"><div class="markdown"><p>Creates a heartbeat message.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/cabec88e9969ae94183684dafb62c8d0dc46a1c8/kernel/src/kernel/core/message.cljc#L27">view source</a></div></div><div class="public anchor" id="var-make-leave"><h3>make-leave</h3><div class="usage"><code>(make-leave site-ID)</code></div><div class="doc"><div class="markdown"><p>Creates a leave message.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/cabec88e9969ae94183684dafb62c8d0dc46a1c8/kernel/src/kernel/core/message.cljc#L34">view source</a></div></div><div class="public anchor" id="var-make-operation"><h3>make-operation</h3><div class="usage"><code>(make-operation CO site-ID)</code></div><div class="doc"><div class="markdown"><p>Creates an operation message from a compound operation.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/cabec88e9969ae94183684dafb62c8d0dc46a1c8/kernel/src/kernel/core/message.cljc#L22">view source</a></div></div><div class="public anchor" id="var-operation-.3ECO"><h3>operation-&gt;CO</h3><div class="usage"><code>(operation-&gt;CO operation)</code></div><div class="doc"><div class="markdown"><p>Extracts the compound operation from an operation message. This is done by discarding the site that generated the operation. Advised because an operation’s site may leave at any time, and no orphaned site identifiers should remain in the system.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/cabec88e9969ae94183684dafb62c8d0dc46a1c8/kernel/src/kernel/core/message.cljc#L83">view source</a></div></div><div class="public anchor" id="var-remove-server-VC"><h3>remove-server-VC</h3><div class="usage"><code>(remove-server-VC message)</code></div><div class="doc"><div class="markdown"><p>Removes a message’s server vector clock.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/cabec88e9969ae94183684dafb62c8d0dc46a1c8/kernel/src/kernel/core/message.cljc#L65">view source</a></div></div><div class="public anchor" id="var-update-VC"><h3>update-VC</h3><div class="usage"><code>(update-VC message f)</code></div><div class="doc"><div class="markdown"><p>Updates a message’s vector clock with a given updater function.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/cabec88e9969ae94183684dafb62c8d0dc46a1c8/kernel/src/kernel/core/message.cljc#L53">view source</a></div></div><div class="public anchor" id="var-with-server-VC"><h3>with-server-VC</h3><div class="usage"><code>(with-server-VC message server-VC)</code></div><div class="doc"><div class="markdown"><p>Updates a message’s server vector clock.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/cabec88e9969ae94183684dafb62c8d0dc46a1c8/kernel/src/kernel/core/message.cljc#L70">view source</a></div></div></div></body></html>