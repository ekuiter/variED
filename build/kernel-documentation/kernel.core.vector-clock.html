<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>kernel.core.vector-clock documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Kernel</span> <span class="project-version">SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kernel</span></div></div></li><li class="depth-2 branch"><a href="kernel.api.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></a></li><li class="depth-2"><a href="kernel.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.causal-dag.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>causal-dag</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.compound-operation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compound-operation</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.conflict-cache.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>conflict-cache</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.conflict-relation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>conflict-relation</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.conflict-resolution.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>conflict-resolution</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.feature-model.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>feature-model</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.garbage-collector.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>garbage-collector</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.history-buffer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>history-buffer</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.message.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>message</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.movic.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>movic</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.primitive-operation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>primitive-operation</span></div></a></li><li class="depth-3 branch"><a href="kernel.core.topological-sort.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>topological-sort</span></div></a></li><li class="depth-3 current"><a href="kernel.core.vector-clock.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vector-clock</span></div></a></li><li class="depth-2 branch"><a href="kernel.helpers.html"><div class="inner"><span class="tree" style="top: -424px;"><span class="top" style="height: 433px;"></span><span class="bottom"></span></span><span>helpers</span></div></a></li><li class="depth-2 branch"><a href="kernel.i18n.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>i18n</span></div></a></li><li class="depth-2"><a href="kernel.shell.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>shell</span></div></a></li><li class="depth-3 branch"><a href="kernel.shell.client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></a></li><li class="depth-3 branch"><a href="kernel.shell.context.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>context</span></div></a></li><li class="depth-3 branch"><a href="kernel.shell.server.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>server</span></div></a></li><li class="depth-3"><a href="kernel.shell.site.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>site</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="kernel.core.vector-clock.html#var-_.3C"><div class="inner"><span>_&lt;</span></div></a></li><li class="depth-1"><a href="kernel.core.vector-clock.html#var-_get"><div class="inner"><span>_get</span></div></a></li><li class="depth-1"><a href="kernel.core.vector-clock.html#var-_merge"><div class="inner"><span>_merge</span></div></a></li><li class="depth-1"><a href="kernel.core.vector-clock.html#var-increment"><div class="inner"><span>increment</span></div></a></li><li class="depth-1"><a href="kernel.core.vector-clock.html#var-initialize"><div class="inner"><span>initialize</span></div></a></li><li class="depth-1"><a href="kernel.core.vector-clock.html#var-remove-site"><div class="inner"><span>remove-site</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">kernel.core.vector-clock</h1><div class="doc"><div class="markdown"><p>Vector Clock, VC for short. Vector clocks are used to track causality of operations in the system.</p>
<p>An operation causes another if it happened before. This is difficult to achieve with physical clocks because of clock skew. Also, physical time can not capture whether two operations are concurrent (i.e., generated without knowledge of the other).</p>
<p>In contrast, vector clocks can capture the causally-preceding relation precisely. The algorithms were introduced by Fidge and Mattern. Adapted from <a href="https://github.com/michaelklishin/vclock">https://github.com/michaelklishin/vclock</a>.</p>
<p>Here, a vector clock maps from sites to integers counting events. This is not the most efficient implementation (there are garbage collection techniques in the literature).</p></div></div><div class="public anchor" id="var-_.3C"><h3>_&lt;</h3><div class="usage"><code>(_&lt; VC-a VC-b)</code></div><div class="doc"><div class="markdown"><p>Compares two vector clocks in O(n) for n sites. Returns true if one vector clock causally precedes the other.</p>
<p>Because new sites may join at any time, some sites may be missing in one of the vector clocks, so they are explicitly collected first.</p>
<p>Derivation of the algorithm from the vector clock definition (z refers to sites, x and y are the compared vector clocks):</p>
<pre><code>  (for all z: xz &lt;= yz) and (exists z: xz &lt; yz)
= not not ((for all z: xz &lt;= yz) and (exists z: xz &lt; yz))
= not (not (for all z: xz &lt;= yz) or not (exists z: xz &lt; yz))
= not ((exists z: not xz &lt;= yz) or (for all z: not xz &lt; yz))
= not ((exists z: xz &gt; yz) or (for all z: xz &gt;= yz))
i.e.: check if all z: xz &gt;= yz, and if a z: xz &gt; yz is found, return early
i.e.: cond &gt; return early (true)
      else = continue with current value
      else &lt; continue with false (but no early return, as exists may still be true)
   =&gt; then do final not
</code></pre></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/6ddbe6435c3e25753416dedbb3c063106aecf95b/kernel/src/kernel/core/vector_clock.cljc#L54">view source</a></div></div><div class="public anchor" id="var-_get"><h3>_get</h3><div class="usage"><code>(_get VC site-ID)</code></div><div class="doc"><div class="markdown"><p>Returns a site’s coordinate in a vector clock in O(1), defaulting to 0.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/6ddbe6435c3e25753416dedbb3c063106aecf95b/kernel/src/kernel/core/vector_clock.cljc#L30">view source</a></div></div><div class="public anchor" id="var-_merge"><h3>_merge</h3><div class="usage"><code>(_merge VC-a VC-b)</code></div><div class="doc"><div class="markdown"><p>Merges two vector clocks by taking the maximum component-wise in O(n) for n sites.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/6ddbe6435c3e25753416dedbb3c063106aecf95b/kernel/src/kernel/core/vector_clock.cljc#L48">view source</a></div></div><div class="public anchor" id="var-increment"><h3>increment</h3><div class="usage"><code>(increment VC site-ID)</code></div><div class="doc"><div class="markdown"><p>Increments a site’s counter in a vector clock in O(1).</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/6ddbe6435c3e25753416dedbb3c063106aecf95b/kernel/src/kernel/core/vector_clock.cljc#L37">view source</a></div></div><div class="public anchor" id="var-initialize"><h3>initialize</h3><div class="usage"><code>(initialize)</code></div><div class="doc"><div class="markdown"><p>Creates a new empty vector clock. Every site’s counter is implicitly 0.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/6ddbe6435c3e25753416dedbb3c063106aecf95b/kernel/src/kernel/core/vector_clock.cljc#L22">view source</a></div></div><div class="public anchor" id="var-remove-site"><h3>remove-site</h3><div class="usage"><code>(remove-site VC site-ID)</code></div><div class="doc"><div class="markdown"><p>Removes a site from a vector clock in O(1). This effectively resets the site’s counter to 0.</p></div></div><div class="src-link"><a href="https://github.com/ekuiter/variED/blob/6ddbe6435c3e25753416dedbb3c063106aecf95b/kernel/src/kernel/core/vector_clock.cljc#L42">view source</a></div></div></div></body></html>