task build {
    dependsOn ':clean', ':client:build', ':server:build'
    doLast() {
        copy {
            from 'server/build/libs'
            into 'build'
        }
    }
}

task stage(dependsOn: 'build')

task clean {
    doLast {
        delete 'build'
    }
}

tasks.getByPath(':client:build').mustRunAfter ':clean'
tasks.getByPath(':server:build').mustRunAfter ':clean'
tasks.getByPath(':server:build').mustRunAfter ':client:build'